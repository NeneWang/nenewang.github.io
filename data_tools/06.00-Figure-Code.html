
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Appendix: Figure Code</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-examples.css?v=e236af4b" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=ebe79ad7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=b1422caa"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-52617120-7"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-52617120-7');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-52617120-7');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"9b5cfcbf1cb54facb25b78029b122ac0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d7c84093d94c46959a46bd0ec51c1391": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_0e2ee13a90cc4438ab75dbe863c8473a", "IPY_MODEL_23f86dcc833442988e7272aab6bce181", "IPY_MODEL_572fc21249274aacaa0979a7d12aa9ce"], "layout": "IPY_MODEL_9b5cfcbf1cb54facb25b78029b122ac0", "tabbable": null, "tooltip": null}}, "7bf37eddf35844ecb5bdaceb4ff619a3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8396a10b73e844a195068c14721306be": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "0e2ee13a90cc4438ab75dbe863c8473a": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "IntSliderView", "behavior": "drag-tap", "continuous_update": true, "description": "frame", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_7bf37eddf35844ecb5bdaceb4ff619a3", "max": 50, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_8396a10b73e844a195068c14721306be", "tabbable": null, "tooltip": null, "value": 0}}, "743e0af620e143dbb0b3896f5e2f8cff": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e3f1651641a14f28a8fbb077e4d33ee1": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "23f86dcc833442988e7272aab6bce181": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["1", "6"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "n_clusters", "description_allow_html": false, "disabled": false, "index": 0, "layout": "IPY_MODEL_743e0af620e143dbb0b3896f5e2f8cff", "style": "IPY_MODEL_e3f1651641a14f28a8fbb077e4d33ee1", "tabbable": null, "tooltip": null}}, "812e54a582824ee78e5a9d8d783e7e3f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "572fc21249274aacaa0979a7d12aa9ce": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_812e54a582824ee78e5a9d8d783e7e3f", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<Figure size 640x480 with 1 Axes>", "image/png": "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\n"}}], "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'data_tools/06.00-Figure-Code';</script>
    <link rel="canonical" href="https://jupyterbook.org/data_tools/06.00-Figure-Code.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-wide.svg" class="logo__image only-light" alt=" - Home"/>
    <script>document.write(`<img src="../_static/logo-wide.svg" class="logo__image only-dark" alt=" - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About these Notes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1-intro/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1-intro/syllabus.html">Syllabus</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Current Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../algorithms/intro.html">Introduction to Analysis of Algorithms</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../start/your-first-book.html">Create your first book</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../start/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start/create.html">Create a template book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start/build.html">Build your book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start/new-file.html">Create your own content file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start/publish.html">Publish your book online</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start/example-book.html">Build a small example project</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/references.html">Get started with references</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Topic Guides</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../basics/organize.html">Structure and organize content</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../structure/toc.html">Structure the Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structure/configure.html">Configure the Table of Contents</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../file-types/index.html">Types of content source files</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../file-types/markdown.html">Markdown files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../file-types/notebooks.html">Jupyter Notebook files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../file-types/myst-notebooks.html">Notebooks written entirely in Markdown</a></li>
<li class="toctree-l3"><a class="reference internal" href="../file-types/jupytext.html">Custom notebook formats and Jupytext</a></li>
<li class="toctree-l3"><a class="reference internal" href="../file-types/restructuredtext.html">reStructuredText files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics/create.html">Create books automatically</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structure/sections-headers.html">How headers and sections map onto to book structure</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../content/index.html">Write narrative content</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../content/myst.html">MyST Markdown overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/content-blocks.html">Special content blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/components.html">Components and UI elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/references.html">References and cross-references</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/layout.html">Control the page layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/citations.html">Citations and bibliographies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/math.html">Math and equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/proof.html">Proofs, Theorems, and Algorithms</a></li>

<li class="toctree-l2"><a class="reference internal" href="../content/figures.html">Images and figures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/metadata.html">Add metadata to your book pages</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../content/executable/index.html">Write executable content</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../content/execute.html">Execute and cache your pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/code-outputs.html">Formatting code outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../content/executable/output-insert.html">Store code outputs and insert into content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactive/interactive.html">Interactive data visualizations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../basics/building/index.html">Build and publish outputs</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/build.html">Build from the command line</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../publish/web.html">Publish your book on the internet</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../publish/gh-pages.html">GitHub Pages and Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../publish/netlify.html">Netlify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../publish/readthedocs.html">Read the Docs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/pdf.html">Build a PDF</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../web/index.html">Web and internet features</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/repository.html">Connect your book to a code repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactive/hiding.html">Hide or remove content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactive/launchbuttons.html">Launch into interactive computing interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactive/thebe.html">Make your code cells executable</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../interactive/comments.html">Commenting and annotating</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../interactive/comments/hypothesis.html">Hypothesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interactive/comments/utterances.html">Utterances</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../web/announcements.html">Announcement banners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/html.html">Advanced HTML outputs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sphinx/index.html">Sphinx usage and customization</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/sphinx.html">Advanced Sphinx usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/developers.html">Developer workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../explain/sphinx.html">How Jupyter Book and Sphinx relate to one another</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced/index.html">Advanced Jupyter Book Usage</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/windows.html">Working on Windows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/intro.html">Contribute to Jupyter Book</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../customize/config.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/cheatsheet.html">MyST syntax cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/cli.html">Command-line interface reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About Jupyter Book</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://executablebooks.org/en/latest/gallery">Gallery of Jupyter Books</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explain/components.html">The Jupyter Book toolchain and components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Cite Jupyter Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explain/migration.html">Migrating to <code class="docutils literal notranslate"><span class="pre">jupyter-book&gt;=0.14</span></code></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/NeneWang/lecture-notes/master?urlpath=tree/docs/data_tools/06.00-Figure-Code.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/NeneWang/lecture-notes/blob/master/docs/data_tools/06.00-Figure-Code.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NeneWang/lecture-notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NeneWang/lecture-notes/edit/master/docs/data_tools/06.00-Figure-Code.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NeneWang/lecture-notes/issues/new?title=Issue%20on%20page%20%2Fdata_tools/06.00-Figure-Code.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/data_tools/06.00-Figure-Code.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Appendix: Figure Code</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">Broadcasting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation-and-grouping">Aggregation and Grouping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-apply-combine">Split-Apply-Combine</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-machine-learning">What Is Machine Learning?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-example-figures">Classification Example Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-example-figure-1">Classification Example Figure 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-example-figure-2">Classification Example Figure 2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-example-figure-3">Classification Example Figure 3</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figures">Regression Example Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figure-1">Regression Example Figure 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figure-2">Regression Example Figure 2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figure-3">Regression Example Figure 3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figure-4">Regression Example Figure 4</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-example-figures">Clustering Example Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-example-figure-1">Clustering Example Figure 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-example-figure-2">Clustering Example Figure 2</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensionality-reduction-example-figures">Dimensionality Reduction Example Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensionality-reduction-example-figure-1">Dimensionality Reduction Example Figure 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensionality-reduction-example-figure-2">Dimensionality Reduction Example Figure 2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-scikit-learn">Introducing Scikit-Learn</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#features-and-labels-grid">Features and Labels Grid</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparameters-and-model-validation">Hyperparameters and Model Validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-figures">Cross-Validation Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fold-cross-validation">2-Fold Cross-Validation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">5-Fold Cross-Validation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overfitting-and-underfitting">Overfitting and Underfitting</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bias-variance-tradeoff">Bias-Variance Tradeoff</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bias-variance-tradeoff-metrics">Bias-Variance Tradeoff Metrics</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-curve">Validation Curve</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-curve">Learning Curve</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-naive-bayes">Gaussian Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-naive-bayes-example">Gaussian Naive Bayes Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-basis-functions">Gaussian Basis Functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forests">Random Forests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-code">Helper Code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree-example">Decision Tree Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree-levels">Decision Tree Levels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree-overfitting">Decision Tree Overfitting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-component-analysis">Principal Component Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-components-rotation">Principal Components Rotation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digits-pixel-components">Digits Pixel Components</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digits-pca-components">Digits PCA Components</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manifold-learning">Manifold Learning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lle-vs-mds-linkages">LLE vs MDS Linkages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means">K-Means</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-maximization">Expectation-Maximization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-k-means">Interactive K-Means</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-mixture-models">Gaussian Mixture Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#covariance-type">Covariance Type</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="appendix-figure-code">
<h1>Appendix: Figure Code<a class="headerlink" href="#appendix-figure-code" title="Link to this heading">#</a></h1>
<p>Many of the figures used throughout this text are created in-place by code that appears in print.
In a few cases, however, the required code is long enough (or not immediately relevant enough) that we instead put it here for reference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;figures&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;figures&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="broadcasting">
<h2>Broadcasting<a class="headerlink" href="#broadcasting" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="02.05-Computation-on-arrays-broadcasting.html#Introducing-Broadcasting"><span class="std std-ref">Figure Context</span></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adapted from astroML: see http://www.astroml.org/book_figures/appendix/fig_broadcast_visual.html</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1">#------------------------------------------------------------</span>
<span class="c1"># Draw a figure and axis with no boundary</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
              <span class="n">edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;draw and label a cube.  edges is a list of numbers between</span>
<span class="sd">    1 and 12, specifying which of the 12 cube edges to draw&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>

    <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">3</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">4</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="mi">5</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">depth</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">6</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">size</span> <span class="o">+</span> <span class="n">depth</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">7</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">size</span> <span class="o">+</span> <span class="n">depth</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">depth</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">8</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">depth</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">depth</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="mi">9</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">depth</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">10</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="n">depth</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">11</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">depth</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="n">depth</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">depth</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">12</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">depth</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">depth</span><span class="p">],</span>
                <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="n">depth</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">depth</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">label_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">label_kwargs</span><span class="p">)</span>

<span class="n">solid</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">label_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">))</span>
<span class="n">dotted</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">label_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">))</span>
<span class="n">depth</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="c1">#------------------------------------------------------------</span>
<span class="c1"># Draw top operation: vector plus scalar</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">10.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">11.5</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;${\tt np.arange(3) + 5}$&#39;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="c1">#------------------------------------------------------------</span>
<span class="c1"># Draw middle operation: matrix plus vector</span>

<span class="c1"># first block</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="c1"># second block</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>

<span class="c1"># third block</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">10.5</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;${\tt np.ones((3,\, 3)) + np.arange(3)}$&#39;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="c1">#------------------------------------------------------------</span>
<span class="c1"># Draw bottom operation: vector plus vector, double broadcast</span>

<span class="c1"># first block</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>

<span class="c1"># second block</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">dotted</span><span class="p">)</span>

<span class="c1"># third block</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>
<span class="n">draw_cube</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">solid</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">10.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;${\tt np.arange(3).reshape((3,\, 1)) + np.arange(3)}$&#39;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/02.05-broadcasting.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5c1875099db6a2d771b36ff06dcfc57a2e4f4092196b8888b9f9b14894e2ca62.png" src="../_images/5c1875099db6a2d771b36ff06dcfc57a2e4f4092196b8888b9f9b14894e2ca62.png" />
</div>
</div>
</section>
<section id="aggregation-and-grouping">
<h2>Aggregation and Grouping<a class="headerlink" href="#aggregation-and-grouping" title="Link to this heading">#</a></h2>
<p>Figures from the chapter on aggregation and grouping</p>
<section id="split-apply-combine">
<h3>Split-Apply-Combine<a class="headerlink" href="#split-apply-combine" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">textstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span> <span class="ow">or</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">width</span> <span class="ow">or</span> <span class="mi">1</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">loc</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">ncols</span>

    <span class="k">if</span> <span class="n">linestyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">textstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">textstyle</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>

    <span class="n">textstyle</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;ha&#39;</span><span class="p">:</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;va&#39;</span><span class="p">:</span><span class="s1">&#39;center&#39;</span><span class="p">})</span>

    <span class="c1"># draw vertical lines</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dx</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">],</span> <span class="o">**</span><span class="n">linestyle</span><span class="p">)</span>

    <span class="c1"># draw horizontal lines</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">],</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">[</span><span class="n">y</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dy</span><span class="p">],</span> <span class="o">**</span><span class="n">linestyle</span><span class="p">)</span>

    <span class="c1"># Create index labels</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">,</span>
                 <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="o">**</span><span class="n">textstyle</span><span class="p">)</span>

    <span class="c1"># Create column labels</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">nrows</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">,</span>
                 <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">textstyle</span><span class="p">)</span>
        
    <span class="c1"># Add index label</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">nrows</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">,</span>
                 <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">textstyle</span><span class="p">)</span>

    <span class="c1"># Insert data</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span>
                     <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span><span class="p">,</span>
                     <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]),</span> <span class="o">**</span><span class="n">textstyle</span><span class="p">)</span>


<span class="c1">#----------------------------------------------------------</span>
<span class="c1"># Draw figure</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]},</span>
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;key&#39;</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">draw_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ABC&#39;</span><span class="p">):</span>
    <span class="n">split</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">ind</span><span class="p">]</span>
    <span class="n">draw_dataframe</span><span class="p">(</span><span class="n">split</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>

    <span class="nb">sum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">split</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">T</span>
    <span class="nb">sum</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="nb">sum</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;key&#39;</span>
    <span class="nb">sum</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
    <span class="n">draw_dataframe</span><span class="p">(</span><span class="nb">sum</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">])</span>
    
<span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">draw_dataframe</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>

<span class="n">style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">,</span> <span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">4.6</span><span class="p">,</span> <span class="s2">&quot;Split&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.35</span><span class="p">,</span> <span class="s2">&quot;Apply (sum)&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mf">2.85</span><span class="p">,</span> <span class="s2">&quot;Combine&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>

<span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">3.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">),</span> <span class="p">(</span><span class="mf">5.2</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span> <span class="p">(</span><span class="mf">5.2</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span> <span class="p">(</span><span class="mf">5.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/03.08-split-apply-combine.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f09e74d17ad8797a55cf07b1cbd528f135f37f1de19c7b70a1de02153b6d81cd.png" src="../_images/f09e74d17ad8797a55cf07b1cbd528f135f37f1de19c7b70a1de02153b6d81cd.png" />
</div>
</div>
</section>
</section>
<section id="what-is-machine-learning">
<h2>What Is Machine Learning?<a class="headerlink" href="#what-is-machine-learning" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># common plot formatting for below</span>
<span class="k">def</span> <span class="nf">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;feature 1&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;feature 2&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="classification-example-figures">
<h3>Classification Example Figures<a class="headerlink" href="#classification-example-figures" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="05.01-What-Is-Machine-Learning.html#Classification:-Predicting-Discrete-Labels"><span class="std std-ref">Figure context</span></a></p>
<p>The following code generates the figures from the Classification section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="c1"># create 50 separable points</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">0.60</span><span class="p">)</span>

<span class="c1"># fit the support vector classifier model</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># create some new points to predict</span>
<span class="n">X2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">0.80</span><span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">X2</span><span class="p">[</span><span class="mi">50</span><span class="p">:]</span>

<span class="c1"># predict the labels</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="classification-example-figure-1">
<h4>Classification Example Figure 1<a class="headerlink" href="#classification-example-figure-1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">point_style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">point_style</span><span class="p">)</span>

<span class="c1"># format plot</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Input Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-classification-1.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f3b4b516a8800dccad047b17c277e91b9eebeb0f2aced0650da37d9eda9039ed.png" src="../_images/f3b4b516a8800dccad047b17c277e91b9eebeb0f2aced0650da37d9eda9039ed.png" />
</div>
</div>
</section>
<section id="classification-example-figure-2">
<h4>Classification Example Figure 2<a class="headerlink" href="#classification-example-figure-2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get contours describing the model</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">xy1</span><span class="p">,</span> <span class="n">xy2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">clf</span><span class="o">.</span><span class="n">decision_function</span><span class="p">([</span><span class="n">t</span><span class="p">])</span>
              <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xy1</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">xy2</span><span class="o">.</span><span class="n">flat</span><span class="p">)])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xy1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># plot points and model</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">line_style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                  <span class="n">linestyles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="s1">&#39;dashed&#39;</span><span class="p">],</span>
                  <span class="n">colors</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">point_style</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xy1</span><span class="p">,</span> <span class="n">xy2</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">line_style</span><span class="p">)</span>

<span class="c1"># format plot</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Model Learned from Input Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-classification-2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4ccad7316174c6e5d30598ad1419c3c04e1e532f52458087fa86ad0a5c40bf15.png" src="../_images/4ccad7316174c6e5d30598ad1419c3c04e1e532f52458087fa86ad0a5c40bf15.png" />
</div>
</div>
</section>
<section id="classification-example-figure-3">
<h4>Classification Example Figure 3<a class="headerlink" href="#classification-example-figure-3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0625</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">point_style</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y2</span><span class="p">,</span> <span class="o">**</span><span class="n">point_style</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xy1</span><span class="p">,</span> <span class="n">xy2</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">line_style</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Unknown Data&#39;</span><span class="p">)</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Predicted Labels&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-classification-3.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/533cb94f61bd511211eee7238c10459b69bdf0923cb620188408fb7813550fb6.png" src="../_images/533cb94f61bd511211eee7238c10459b69bdf0923cb620188408fb7813550fb6.png" />
</div>
</div>
</section>
</section>
<section id="regression-example-figures">
<h3>Regression Example Figures<a class="headerlink" href="#regression-example-figures" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="05.01-What-Is-Machine-Learning.html#Regression:-Predicting-Continuous-Labels"><span class="std std-ref">Figure Context</span></a></p>
<p>The following code generates the figures from the regression section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="c1"># Create some data for the regression</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># fit the regression model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># create some new points to predict</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># predict the labels</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="regression-example-figure-1">
<h4>Regression Example Figure 1<a class="headerlink" href="#regression-example-figure-1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot data points</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

<span class="c1"># format plot</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Input Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-regression-1.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f1f25ade5858057b31459e23b582984a2b72836dc018dbdd5ae393d669547dcd.png" src="../_images/f1f25ade5858057b31459e23b582984a2b72836dc018dbdd5ae393d669547dcd.png" />
</div>
</div>
</section>
<section id="regression-example-figure-2">
<h4>Regression Example Figure 2<a class="headerlink" href="#regression-example-figure-2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Line3DCollection</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">points</span><span class="p">,</span> <span class="n">points</span><span class="p">])</span>
<span class="n">segments</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>

<span class="c1"># plot points in 3D</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span>
           <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">Line3DCollection</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">8</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
           <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

<span class="c1"># format plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">azim</span><span class="o">=-</span><span class="mi">70</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">zaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;feature 1&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;feature 2&#39;</span><span class="p">,</span> <span class="n">zlabel</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>

<span class="c1"># Hide axes (is there a better way?)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">w_xaxis</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">w_yaxis</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">w_zaxis</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">w_xaxis</span><span class="o">.</span><span class="n">get_ticklines</span><span class="p">():</span>
    <span class="n">tick</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">w_yaxis</span><span class="o">.</span><span class="n">get_ticklines</span><span class="p">():</span>
    <span class="n">tick</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">w_zaxis</span><span class="o">.</span><span class="n">get_ticklines</span><span class="p">():</span>
    <span class="n">tick</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-regression-2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c5e429b6c63dcda511ca84ad4e0ead5e07dcb90f1453d18c6441879f973f9e47.png" src="../_images/c5e429b6c63dcda511ca84ad4e0ead5e07dcb90f1453d18c6441879f973f9e47.png" />
</div>
</div>
</section>
<section id="regression-example-figure-3">
<h4>Regression Example Figure 3<a class="headerlink" href="#regression-example-figure-3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">LineCollection</span>

<span class="c1"># plot data points</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># compute and plot model color mesh</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">Xfit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>
<span class="n">yfit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xfit</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="n">yfit</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">pcolorfast</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">zz</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">pts</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># format plot</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Input Data with Linear Fit&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-regression-3.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/85beb963ef065e741f19b03b153ce466348b15c2bac789720d1323b3dd0889ad.png" src="../_images/85beb963ef065e741f19b03b153ce466348b15c2bac789720d1323b3dd0889ad.png" />
</div>
</div>
</section>
<section id="regression-example-figure-4">
<h4>Regression Example Figure 4<a class="headerlink" href="#regression-example-figure-4" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the model fit</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0625</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">pts</span><span class="o">.</span><span class="n">norm</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># format plots</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Unknown Data&#39;</span><span class="p">)</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Predicted Labels&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-regression-4.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/249a90894cb61cef3a78109fa35c6ccb13da845ec9ea7f81ee1f10cf03e200b3.png" src="../_images/249a90894cb61cef3a78109fa35c6ccb13da845ec9ea7f81ee1f10cf03e200b3.png" />
</div>
</div>
</section>
</section>
<section id="clustering-example-figures">
<h3>Clustering Example Figures<a class="headerlink" href="#clustering-example-figures" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="#Clustering:-Inferring-Labels-on-Unlabeled-Data"><span class="xref myst">Figure context</span></a></p>
<p>The following code generates the figures from the clustering section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="c1"># create 50 separable points</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                  <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Fit the K Means model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<section id="clustering-example-figure-1">
<h4>Clustering Example Figure 1<a class="headerlink" href="#clustering-example-figure-1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the input data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1"># format the plot</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Input Data&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-clustering-1.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/61e0460f54965a61c7c4245113020d6f270353288fea91c760c9e998510cf5e4.png" src="../_images/61e0460f54965a61c7c4245113020d6f270353288fea91c760c9e998510cf5e4.png" />
</div>
</div>
</section>
<section id="clustering-example-figure-2">
<h4>Clustering Example Figure 2<a class="headerlink" href="#clustering-example-figure-2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the data with cluster labels</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

<span class="c1"># format the plot</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Learned Cluster Labels&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-clustering-2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ba397b6daf60ce57a280376c879919cd87583ee36dcd781fe36372beabaf2c93.png" src="../_images/ba397b6daf60ce57a280376c879919cd87583ee36dcd781fe36372beabaf2c93.png" />
</div>
</div>
</section>
</section>
<section id="dimensionality-reduction-example-figures">
<h3>Dimensionality Reduction Example Figures<a class="headerlink" href="#dimensionality-reduction-example-figures" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="05.01-What-Is-Machine-Learning.html#Dimensionality-Reduction:-Inferring-Structure-of-Unlabeled-Data"><span class="std std-ref">Figure context</span></a></p>
<p>The following code generates the figures from the dimensionality reduction section.</p>
<section id="dimensionality-reduction-example-figure-1">
<h4>Dimensionality Reduction Example Figure 1<a class="headerlink" href="#dimensionality-reduction-example-figure-1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_swiss_roll</span>

<span class="c1"># make data</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_swiss_roll</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="c1"># visualize data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># format the plot</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Input Data&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-dimesionality-1.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d795dac5b0e22cbce40258079290eb57c18f8b73395b98cd8e674760189882e6.png" src="../_images/d795dac5b0e22cbce40258079290eb57c18f8b73395b98cd8e674760189882e6.png" />
</div>
</div>
</section>
<section id="dimensionality-reduction-example-figure-2">
<h4>Dimensionality Reduction Example Figure 2<a class="headerlink" href="#dimensionality-reduction-example-figure-2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">Isomap</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Isomap</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># visualize data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y_fit</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># format the plot</span>
<span class="n">format_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Learned Latent Parameter&#39;</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Latent Variable&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.01-dimesionality-2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04c930b67e78088ef273049b0924684b42bfe5bc6a07a64116a8eeb7a5c4c45c.png" src="../_images/04c930b67e78088ef273049b0924684b42bfe5bc6a07a64116a8eeb7a5c4c45c.png" />
</div>
</div>
</section>
</section>
</section>
<section id="introducing-scikit-learn">
<h2>Introducing Scikit-Learn<a class="headerlink" href="#introducing-scikit-learn" title="Link to this heading">#</a></h2>
<section id="features-and-labels-grid">
<h3>Features and Labels Grid<a class="headerlink" href="#features-and-labels-grid" title="Link to this heading">#</a></h3>
<p>The following is the code generating the diagram showing the features matrix and target array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Draw features matrix</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">font_prop</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Feature Matrix ($X$)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;n_features $\longrightarrow$&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">font_prop</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\longleftarrow$ n_samples&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">font_prop</span><span class="p">)</span>

<span class="c1"># Draw labels vector</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Target Vector ($y$)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">7.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\longleftarrow$ n_samples&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">font_prop</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.02-samples-features.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/14985f0246abafca99ac2e3686d56f6b802f0ffa046846828fdc37b9f387c319.png" src="../_images/14985f0246abafca99ac2e3686d56f6b802f0ffa046846828fdc37b9f387c319.png" />
</div>
</div>
</section>
</section>
<section id="hyperparameters-and-model-validation">
<h2>Hyperparameters and Model Validation<a class="headerlink" href="#hyperparameters-and-model-validation" title="Link to this heading">#</a></h2>
<section id="cross-validation-figures">
<h3>Cross-Validation Figures<a class="headerlink" href="#cross-validation-figures" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_rects</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">textprop</span><span class="o">=</span><span class="p">{}):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">5.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">/</span> <span class="n">N</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="mf">5.</span> <span class="o">/</span> <span class="n">N</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">5.</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">0.35</span><span class="p">,</span>
                <span class="s2">&quot;validation</span><span class="se">\n</span><span class="s2">set&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">textprop</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">0.35</span><span class="p">,</span> <span class="s2">&quot;trial </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="o">**</span><span class="n">textprop</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="fold-cross-validation">
<h4>2-Fold Cross-Validation<a class="headerlink" href="#fold-cross-validation" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">draw_rects</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">textprop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.03-2-fold-CV.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/93ab93757dec7100c90cee8426f51ffecf69cc6daa7921d60e531e6a891b43b2.png" src="../_images/93ab93757dec7100c90cee8426f51ffecf69cc6daa7921d60e531e6a891b43b2.png" />
</div>
</div>
</section>
<section id="id1">
<h4>5-Fold Cross-Validation<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">draw_rects</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">textprop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.03-5-fold-CV.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b9f79600847b92c125ca74c4b57e541b226811b719328b8c6ede519b4286ef8e.png" src="../_images/b9f79600847b92c125ca74c4b57e541b226811b719328b8c6ede519b4286ef8e.png" />
</div>
</div>
</section>
</section>
<section id="overfitting-and-underfitting">
<h3>Overfitting and Underfitting<a class="headerlink" href="#overfitting-and-underfitting" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">make_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">rseed</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># randomly sample the data</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="n">err</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="k">def</span> <span class="nf">PolynomialRegression</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="p">),</span>
                         <span class="n">LinearRegression</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<section id="bias-variance-tradeoff">
<h4>Bias-Variance Tradeoff<a class="headerlink" href="#bias-variance-tradeoff" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">()</span>
<span class="n">xfit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">PolynomialRegression</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">model20</span> <span class="o">=</span> <span class="n">PolynomialRegression</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0625</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;High-bias model: Underfits the data&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">model20</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;High-variance model: Overfits the data&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.03-bias-variance.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b61524fa5770d6a3a123ca40a6221a4e47cac0fe20da6aeeaf2ed2ee74574dca.png" src="../_images/b61524fa5770d6a3a123ca40a6221a4e47cac0fe20da6aeeaf2ed2ee74574dca.png" />
</div>
</div>
</section>
<section id="bias-variance-tradeoff-metrics">
<h4>Bias-Variance Tradeoff Metrics<a class="headerlink" href="#bias-variance-tradeoff-metrics" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0625</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">X2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">rseed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;High-bias model: Underfits the data&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s2">&quot;training score: $R^2$ = </span><span class="si">{0:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)),</span>
           <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="s2">&quot;validation score: $R^2$ = </span><span class="si">{0:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)),</span>
           <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">model20</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;High-variance model: Overfits the data&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s2">&quot;training score: $R^2$ = </span><span class="si">{0:.2g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model20</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)),</span>
           <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="s2">&quot;validation score: $R^2$ = </span><span class="si">{0:.2g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model20</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)),</span>
           <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.03-bias-variance-2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dfb4e10bc3306977c55bbbfdd41c368ce4cd81c8f50eb74644c5851b4eb8df16.png" src="../_images/dfb4e10bc3306977c55bbbfdd41c368ce4cd81c8f50eb74644c5851b4eb8df16.png" />
</div>
</div>
</section>
<section id="validation-curve">
<h4>Validation Curve<a class="headerlink" href="#validation-curve" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="mf">0.33</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s2">&quot;training score&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="s2">&quot;validation score&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\longleftarrow$ High Bias&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\longleftarrow$ High Variance $\longrightarrow$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.48</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="s1">&#39;Best$</span><span class="se">\\</span><span class="s1">longrightarrow$</span><span class="se">\n</span><span class="s1">Model&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;model complexity $\longrightarrow$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;model score $\longrightarrow$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Validation Curve Schematic&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.03-validation-curve.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f5537c06bdbe7406eefbf3b78453e736260a65ef97a42eff95ea892a0e240783.png" src="../_images/f5537c06bdbe7406eefbf3b78453e736260a65ef97a42eff95ea892a0e240783.png" />
</div>
</div>
</section>
<section id="learning-curve">
<h4>Learning Curve<a class="headerlink" href="#learning-curve" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">-</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="s2">&quot;training score&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;validation score&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Good Fit $\longrightarrow$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\longleftarrow$ High Variance $\longrightarrow$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;training set size $\longrightarrow$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;model score $\longrightarrow$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Learning Curve Schematic&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.03-learning-curve.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0a3e5e4a3b1ad2df62f6ecd05880c26ae841cc5be4312fe1ec2f798ffe3ecd6e.png" src="../_images/0a3e5e4a3b1ad2df62f6ecd05880c26ae841cc5be4312fe1ec2f798ffe3ecd6e.png" />
</div>
</div>
</section>
</section>
</section>
<section id="gaussian-naive-bayes">
<h2>Gaussian Naive Bayes<a class="headerlink" href="#gaussian-naive-bayes" title="Link to this heading">#</a></h2>
<section id="gaussian-naive-bayes-example">
<h3>Gaussian Naive Bayes Example<a class="headerlink" href="#gaussian-naive-bayes-example" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="05.05-Naive-Bayes.html#Gaussian-Naive-Bayes"><span class="std std-ref">Figure Context</span></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Naive Bayes Model&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">yg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">)</span>
<span class="n">Xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">label</span><span class="p">)</span>
    <span class="n">mu</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Xgrid</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">std</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Pm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">P</span> <span class="o">&lt;</span> <span class="mf">0.03</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">pcolorfast</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">,</span> <span class="n">Pm</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">cmap</span><span class="o">=</span><span class="n">color</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span>
               <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
               <span class="n">colors</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.05-gaussian-NB.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d3a74cf51d302b61b7cb32498f86ba18d70e4efe85701857bdad81283681f318.png" src="../_images/d3a74cf51d302b61b7cb32498f86ba18d70e4efe85701857bdad81283681f318.png" />
</div>
</div>
</section>
</section>
<section id="linear-regression">
<h2>Linear Regression<a class="headerlink" href="#linear-regression" title="Link to this heading">#</a></h2>
<section id="gaussian-basis-functions">
<h3>Gaussian Basis Functions<a class="headerlink" href="#gaussian-basis-functions" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="05.06-Linear-Regression.html#Gaussian-Basis-Functions"><span class="std std-ref">Figure Context</span></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span>

<span class="k">class</span> <span class="nc">GaussianFeatures</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uniformly-spaced Gaussian Features for 1D input&quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">width_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_factor</span> <span class="o">=</span> <span class="n">width_factor</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_gauss_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">width</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">arg</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="p">))</span>
        
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># create N centers spread along the data range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centers_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_factor</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">centers_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">centers_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>
        
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gauss_basis</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">centers_</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">width_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">xfit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">gauss_model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">GaussianFeatures</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                            <span class="n">LinearRegression</span><span class="p">())</span>
<span class="n">gauss_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">=</span> <span class="n">gauss_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>

<span class="n">gf</span> <span class="o">=</span> <span class="n">gauss_model</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;gaussianfeatures&#39;</span><span class="p">]</span>
<span class="n">lm</span> <span class="o">=</span> <span class="n">gauss_model</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;linearregression&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">selector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">selector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Xfit</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xfit</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">*</span> <span class="n">selector</span>
    <span class="n">yfit</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xfit</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">yfit</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">gauss_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yfit</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mf">1.5</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.06-gaussian-basis.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7e15c6a93b732463c4949c51ac2cc859d3d728a5d9998dd623bb963a8f7aaa10.png" src="../_images/7e15c6a93b732463c4949c51ac2cc859d3d728a5d9998dd623bb963a8f7aaa10.png" />
</div>
</div>
</section>
</section>
<section id="random-forests">
<h2>Random Forests<a class="headerlink" href="#random-forests" title="Link to this heading">#</a></h2>
<section id="helper-code">
<h3>Helper Code<a class="headerlink" href="#helper-code" title="Link to this heading">#</a></h3>
<p>The following will create a module <code class="docutils literal notranslate"><span class="pre">helpers_05_08.py</span></code> which contains some tools used in <a class="reference internal" href="05.08-Random-Forests.html"><span class="std std-doc">In-Depth: Decision Trees and Random Forests</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> helpers_05_08.py

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>


<span class="k">def</span> <span class="nf">visualize_tree</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    
    <span class="c1"># Plot the training points</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
               <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    
    <span class="c1"># fit the estimator</span>
    <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
                         <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span>

    <span class="c1"># Put the result into a color plot</span>
    <span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">contours</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                           <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_classes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span>
                           <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">)</span>
    
    <span class="c1"># Plot the decision boundaries</span>
    <span class="k">def</span> <span class="nf">plot_boundaries</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">tree_</span>
        
            <span class="k">if</span> <span class="n">tree</span><span class="o">.</span><span class="n">feature</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">tree</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tree</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">ylim</span><span class="p">,</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">plot_boundaries</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">children_left</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                <span class="p">[</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tree</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">ylim</span><span class="p">)</span>
                <span class="n">plot_boundaries</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">children_right</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                <span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ylim</span><span class="p">)</span>
        
            <span class="k">elif</span> <span class="n">tree</span><span class="o">.</span><span class="n">feature</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tree</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">plot_boundaries</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">children_left</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xlim</span><span class="p">,</span>
                                <span class="p">[</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tree</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="n">plot_boundaries</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">children_right</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xlim</span><span class="p">,</span>
                                <span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            
    <span class="k">if</span> <span class="n">boundaries</span><span class="p">:</span>
        <span class="n">plot_boundaries</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_tree_interactive</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">interactive_tree</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">visualize_tree</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">interact</span><span class="p">(</span><span class="n">interactive_tree</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">randomized_tree_interactive</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    
    <span class="k">def</span> <span class="nf">fit_randomized_tree</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">visualize_tree</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">[:</span><span class="n">N</span><span class="p">]],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">[:</span><span class="n">N</span><span class="p">]],</span> <span class="n">boundaries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">)</span>
    
    <span class="n">interact</span><span class="p">(</span><span class="n">fit_randomized_tree</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting helpers_05_08.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="decision-tree-example">
<h3>Decision Tree Example<a class="headerlink" href="#decision-tree-example" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Example Decision Tree: Animal Classification&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s2">&quot;How big is</span><span class="se">\n</span><span class="s2">the animal?&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s2">&quot;Does the animal</span><span class="se">\n</span><span class="s2">have horns?&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s2">&quot;Does the animal</span><span class="se">\n</span><span class="s2">have two legs?&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s2">&quot;Are the horns</span><span class="se">\n</span><span class="s2">longer than 10cm?&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s2">&quot;Is the animal</span><span class="se">\n</span><span class="s2">wearing a collar?&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.62</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s2">&quot;Does the animal</span><span class="se">\n</span><span class="s2">have wings?&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s2">&quot;Does the animal</span><span class="se">\n</span><span class="s2">have a tail?&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>

<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s2">&quot;&gt; 1m&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s2">&quot;&lt; 1m&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.66</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.62</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.62</span><span class="p">,</span> <span class="mf">0.72</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.08-decision-tree.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/22f32199d6161cc1c3f95b16f4cec0bb53be96ab095e10f3152a0e1910ec346e.png" src="../_images/22f32199d6161cc1c3f95b16f4cec0bb53be96ab095e10f3152a0e1910ec346e.png" />
</div>
</div>
</section>
<section id="decision-tree-levels">
<h3>Decision Tree Levels<a class="headerlink" href="#decision-tree-levels" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">helpers_05_08</span> <span class="kn">import</span> <span class="n">visualize_tree</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>

        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                  <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">axi</span><span class="p">,</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">depth</span><span class="p">)</span>
    <span class="n">visualize_tree</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axi</span><span class="p">)</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;depth = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">depth</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.08-decision-tree-levels.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/926f0b6b201b31aa98fbf45faf8e8e01dc7d1c37027e463853202fcb387898d1.png" src="../_images/926f0b6b201b31aa98fbf45faf8e8e01dc7d1c37027e463853202fcb387898d1.png" />
</div>
</div>
</section>
<section id="decision-tree-overfitting">
<h3>Decision Tree Overfitting<a class="headerlink" href="#decision-tree-overfitting" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0625</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">visualize_tree</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">boundaries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">visualize_tree</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">boundaries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.08-decision-tree-overfitting.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a1ccf7ec7ff3f89e77627bab911047bb4886b8955843770e61eaeae1e1d291a7.png" src="../_images/a1ccf7ec7ff3f89e77627bab911047bb4886b8955843770e61eaeae1e1d291a7.png" />
</div>
</div>
</section>
</section>
<section id="principal-component-analysis">
<h2>Principal Component Analysis<a class="headerlink" href="#principal-component-analysis" title="Link to this heading">#</a></h2>
<section id="principal-components-rotation">
<h3>Principal Components Rotation<a class="headerlink" href="#principal-components-rotation" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_vector</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">shrinkA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">whiten</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0625</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># plot data</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">length</span><span class="p">,</span> <span class="n">vector</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">vector</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
    <span class="n">draw_vector</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">mean_</span> <span class="o">+</span> <span class="n">v</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>

<span class="c1"># plot principal components</span>
<span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">draw_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">draw_vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;component 1&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;component 2&#39;</span><span class="p">,</span>
          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;principal components&#39;</span><span class="p">,</span>
          <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.09-PCA-rotation.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fb8b281eb1d218e1ac563e8d9403b31e0749fbbd1298747063d7a524b21f3a76.png" src="../_images/fb8b281eb1d218e1ac563e8d9403b31e0749fbbd1298747063d7a524b21f3a76.png" />
</div>
</div>
</section>
<section id="digits-pixel-components">
<h3>Digits Pixel Components<a class="headerlink" href="#digits-pixel-components" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_pca_components</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">coefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">imshape</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                        <span class="n">show_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">coefficients</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">x</span>
        
    <span class="k">if</span> <span class="n">components</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">mean</span>
        

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">n_components</span><span class="p">),</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="nb">bool</span><span class="p">(</span><span class="n">show_mean</span><span class="p">)</span> <span class="o">+</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">imshape</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="n">show</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
    
    <span class="n">approx</span> <span class="o">=</span> <span class="n">mean</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">show_mean</span><span class="p">:</span>
        <span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">mean</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">)</span>
        <span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$1 \cdot \mu$&#39;</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">):</span>
        <span class="n">approx</span> <span class="o">=</span> <span class="n">approx</span> <span class="o">+</span> <span class="n">coefficients</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">components</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">counter</span><span class="p">,</span> <span class="n">components</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sa">r</span><span class="s1">&#39;$c_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">counter</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span>
             <span class="sa">r</span><span class="s2">&quot;$</span><span class="si">{0:.2f}</span><span class="s2"> \cdot c_</span><span class="si">{1}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_mean</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="s1">&#39;$+$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                           <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="n">show</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">approx</span><span class="p">,</span> <span class="s2">&quot;Approx&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>

<span class="n">digits</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_pca_components</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                          <span class="n">show_mean</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.09-digits-pixel-components.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bc121ad628b815fa6a5e441334d4d228cad3490138fa660d581c2f291de40f6c.png" src="../_images/bc121ad628b815fa6a5e441334d4d228cad3490138fa660d581c2f291de40f6c.png" />
</div>
</div>
</section>
<section id="digits-pca-components">
<h3>Digits PCA Components<a class="headerlink" href="#digits-pca-components" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">Xproj</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_pca_components</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">Xproj</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                          <span class="n">pca</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.09-digits-pca-components.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/66b72beab3d86542a56bbd9daa1460ac3501bec99472744d2b4c6325f37b825c.png" src="../_images/66b72beab3d86542a56bbd9daa1460ac3501bec99472744d2b4c6325f37b825c.png" />
</div>
</div>
</section>
</section>
<section id="manifold-learning">
<h2>Manifold Learning<a class="headerlink" href="#manifold-learning" title="Link to this heading">#</a></h2>
<section id="lle-vs-mds-linkages">
<h3>LLE vs MDS Linkages<a class="headerlink" href="#lle-vs-mds-linkages" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_hello</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">rseed</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="c1"># Make a plot with &quot;HELLO&quot; text; save as png</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;HELLO&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">85</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hello.png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    
    <span class="c1"># Open this PNG and draw random points from it</span>
    <span class="kn">from</span> <span class="nn">matplotlib.image</span> <span class="kn">import</span> <span class="n">imread</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;hello.png&#39;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_hello_s_curve</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">make_hello</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">XS</span> <span class="o">=</span> <span class="n">make_hello_s_curve</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">colorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Line3DCollection</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>

<span class="c1"># construct lines for MDS</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">lines_MDS</span> <span class="o">=</span> <span class="p">[(</span><span class="n">XS</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">XS</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">]]</span>

<span class="c1"># construct lines for LLE</span>
<span class="n">nbrs</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XS</span><span class="p">)</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">XS</span><span class="p">[</span><span class="n">ind</span><span class="p">[:</span><span class="mi">100</span><span class="p">]])[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">lines_LLE</span> <span class="o">=</span> <span class="p">[(</span><span class="n">XS</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">XS</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nbrs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MDS Linkages&#39;</span><span class="p">,</span> <span class="s1">&#39;LLE Linkages (100 NN)&#39;</span><span class="p">]</span>

<span class="c1"># plot the results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                       <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">axi</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">lines</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="p">[</span><span class="n">lines_MDS</span><span class="p">,</span> <span class="n">lines_LLE</span><span class="p">]):</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">XS</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">XS</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">XS</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="o">**</span><span class="n">colorize</span><span class="p">);</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">Line3DCollection</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">azim</span><span class="o">=-</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.10-LLE-vs-MDS.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e93cc3f09af14666383602b80206544dfc6ee7a0eb768e13290b5377011e775f.png" src="../_images/e93cc3f09af14666383602b80206544dfc6ee7a0eb768e13290b5377011e775f.png" />
</div>
</div>
</section>
</section>
<section id="k-means">
<h2>K-Means<a class="headerlink" href="#k-means" title="Link to this heading">#</a></h2>
<section id="expectation-maximization">
<h3>Expectation-Maximization<a class="headerlink" href="#expectation-maximization" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="05.11-K-Means.html#K-Means-Algorithm:-Expectation-Maximization"><span class="std std-ref">Figure Context</span></a></p>
<p>The following figure shows a visual depiction of the Expectation-Maximization approach to K Means:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">pairwise_distances_argmin</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                       <span class="n">cluster_std</span><span class="o">=</span><span class="mf">0.60</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">draw_points</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
               <span class="n">s</span><span class="o">=</span><span class="mi">50</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">draw_centers</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
               <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span>
               <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
               <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_ax</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">gs</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">make_ax</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">gs</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s2">&quot;Random Initialization&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax0</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">draw_points</span><span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">draw_centers</span><span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">make_ax</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">gs</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">:</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">make_ax</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">:</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">])</span>
    
    <span class="c1"># E-step</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pairwise_distances_argmin</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
    <span class="n">draw_points</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">draw_centers</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
    
    <span class="c1"># M-step</span>
    <span class="n">new_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
    <span class="n">draw_points</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">draw_centers</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">draw_centers</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">new_centers</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">new_centers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">centers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                     <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        
    
    <span class="c1"># Finish iteration</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="n">new_centers</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s2">&quot;E-Step&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s2">&quot;M-Step&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>


<span class="c1"># Final E-step    </span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">pairwise_distances_argmin</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="n">axf</span> <span class="o">=</span> <span class="n">make_ax</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">gs</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
<span class="n">draw_points</span><span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">draw_centers</span><span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axf</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s2">&quot;Final Clustering&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axf</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>


<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.11-expectation-maximization.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/41abf483796c49264fbd288b9c52eb34e85d8bae53e5b994816e6b538412ff0e.png" src="../_images/41abf483796c49264fbd288b9c52eb34e85d8bae53e5b994816e6b538412ff0e.png" />
</div>
</div>
</section>
<section id="interactive-k-means">
<h3>Interactive K-Means<a class="headerlink" href="#interactive-k-means" title="Link to this heading">#</a></h3>
<p>The following script uses IPythons interactive widgets to demonstrate the K-means algorithm interactively.
Run this within the IPython notebook to explore the expectation maximization algorithm for computing K Means.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">pairwise_distances_argmin</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>

<span class="k">def</span> <span class="nf">plot_kmeans_interactive</span><span class="p">(</span><span class="n">min_clusters</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_clusters</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                      <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">0.60</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">plot_points</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">n_clusters</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            
    <span class="k">def</span> <span class="nf">plot_centers</span><span class="p">(</span><span class="n">centers</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">centers</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                    <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
            

    <span class="k">def</span> <span class="nf">_kmeans_step</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">centers</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">nsteps</span> <span class="o">=</span> <span class="n">frame</span> <span class="o">//</span> <span class="mi">3</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">old_centers</span> <span class="o">=</span> <span class="n">centers</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nsteps</span> <span class="ow">or</span> <span class="n">frame</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">pairwise_distances_argmin</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nsteps</span> <span class="ow">or</span> <span class="n">frame</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)])</span>
                <span class="n">nans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
                <span class="n">centers</span><span class="p">[</span><span class="n">nans</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_centers</span><span class="p">[</span><span class="n">nans</span><span class="p">]</span>

        <span class="c1"># plot the data and cluster centers</span>
        <span class="n">plot_points</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">)</span>
        <span class="n">plot_centers</span><span class="p">(</span><span class="n">old_centers</span><span class="p">)</span>

        <span class="c1"># plot new centers if third frame</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">centers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">old_centers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">plot_centers</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">frame</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="s2">&quot;1. Reassign points to nearest centroid&quot;</span><span class="p">,</span>
                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">frame</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="s2">&quot;2. Update centroids to cluster means&quot;</span><span class="p">,</span>
                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">interact</span><span class="p">(</span><span class="n">_kmeans_step</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
                    <span class="n">n_clusters</span><span class="o">=</span><span class="p">[</span><span class="n">min_clusters</span><span class="p">,</span> <span class="n">max_clusters</span><span class="p">])</span>

<span class="n">plot_kmeans_interactive</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "d7c84093d94c46959a46bd0ec51c1391"}</script></div>
</div>
</section>
</section>
<section id="gaussian-mixture-models">
<h2>Gaussian Mixture Models<a class="headerlink" href="#gaussian-mixture-models" title="Link to this heading">#</a></h2>
<section id="covariance-type">
<h3>Covariance Type<a class="headerlink" href="#covariance-type" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="http://localhost:8888/notebooks/05.12-Gaussian-Mixtures.ipynb#Choosing-the-Covariance-Type">Figure Context</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="kn">import</span> <span class="n">GaussianMixture</span>

<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Ellipse</span>

<span class="k">def</span> <span class="nf">draw_ellipse</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw an ellipse with a given position and covariance&quot;&quot;&quot;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    
    <span class="c1"># Convert covariance to principal axes</span>
    <span class="k">if</span> <span class="n">covariance</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">covariance</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>
    
    <span class="c1"># Draw the Ellipse</span>
    <span class="k">for</span> <span class="n">nsig</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Ellipse</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">nsig</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="n">nsig</span> <span class="o">*</span> <span class="n">height</span><span class="p">,</span>
                             <span class="n">angle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cov_type</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;diag&#39;</span><span class="p">,</span> <span class="s1">&#39;spherical&#39;</span><span class="p">,</span> <span class="s1">&#39;full&#39;</span><span class="p">]):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="n">cov_type</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;covariance_type=&quot;</span><span class="si">{0}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cov_type</span><span class="p">),</span>
                    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">)</span>
    
    <span class="n">draw_ellipse</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">means_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="n">covariances_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/05.12-covariance-type.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c7f188ed09152f4e4dc12c360386452fc699badfb659df988fa164ca97de575a.png" src="../_images/c7f188ed09152f4e4dc12c360386452fc699badfb659df988fa164ca97de575a.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "NeneWang/lecture-notes",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./data_tools"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">Broadcasting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation-and-grouping">Aggregation and Grouping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-apply-combine">Split-Apply-Combine</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-machine-learning">What Is Machine Learning?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-example-figures">Classification Example Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-example-figure-1">Classification Example Figure 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-example-figure-2">Classification Example Figure 2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-example-figure-3">Classification Example Figure 3</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figures">Regression Example Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figure-1">Regression Example Figure 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figure-2">Regression Example Figure 2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figure-3">Regression Example Figure 3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-example-figure-4">Regression Example Figure 4</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-example-figures">Clustering Example Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-example-figure-1">Clustering Example Figure 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-example-figure-2">Clustering Example Figure 2</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensionality-reduction-example-figures">Dimensionality Reduction Example Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensionality-reduction-example-figure-1">Dimensionality Reduction Example Figure 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensionality-reduction-example-figure-2">Dimensionality Reduction Example Figure 2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-scikit-learn">Introducing Scikit-Learn</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#features-and-labels-grid">Features and Labels Grid</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparameters-and-model-validation">Hyperparameters and Model Validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-figures">Cross-Validation Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fold-cross-validation">2-Fold Cross-Validation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">5-Fold Cross-Validation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overfitting-and-underfitting">Overfitting and Underfitting</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bias-variance-tradeoff">Bias-Variance Tradeoff</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bias-variance-tradeoff-metrics">Bias-Variance Tradeoff Metrics</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-curve">Validation Curve</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-curve">Learning Curve</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-naive-bayes">Gaussian Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-naive-bayes-example">Gaussian Naive Bayes Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-basis-functions">Gaussian Basis Functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forests">Random Forests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-code">Helper Code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree-example">Decision Tree Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree-levels">Decision Tree Levels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree-overfitting">Decision Tree Overfitting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-component-analysis">Principal Component Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-components-rotation">Principal Components Rotation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digits-pixel-components">Digits Pixel Components</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digits-pca-components">Digits PCA Components</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manifold-learning">Manifold Learning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lle-vs-mds-linkages">LLE vs MDS Linkages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means">K-Means</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-maximization">Expectation-Maximization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-k-means">Interactive K-Means</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-mixture-models">Gaussian Mixture Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#covariance-type">Covariance Type</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Commoner Artisan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>